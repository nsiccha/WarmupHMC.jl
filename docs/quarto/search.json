[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "WarmupHMC.jl examples",
    "section": "",
    "text": "WIP, postdoctoral advisory recommended/required."
  },
  {
    "objectID": "posteriordb.html",
    "href": "posteriordb.html",
    "title": "Using posteriordb reference draws",
    "section": "",
    "text": "# push!(LOAD_PATH,\"../src/\")\nincludet(\"common.jl\")\nusing PosteriorDB\nusing Statistics, LinearAlgebra, ForwardDiff, DataFrames\nusing Plots\nusing Random\nRandom.seed!(1) \n\n\n\"\"\"\nA posteriorDB posterior.\n\"\"\"\n@dynamic_object PDBPosterior name::String\n\ndatabase(what::PDBPosterior) = PosteriorDB.database()\nposterior(what::PDBPosterior) = PosteriorDB.posterior(what.database, what.name)\nmodel(what::PDBPosterior) = PosteriorDB.model(what.posterior)\ndataset(what::PDBPosterior) = PosteriorDB.dataset(what.posterior)\ndatastring(what::PDBPosterior) = PosteriorDB.load(what.dataset, String)\nreference_posterior(what::PDBPosterior) = PosteriorDB.reference_posterior(what.posterior)\nconstrained_df(what::PDBPosterior) = DataFrame(PosteriorDB.load(what.reference_posterior))\nconstrained_draws(what::PDBPosterior) = hcat([vcat(col...) for col in eachcol(what.constrained_df)]...)\nstan_file(what::PDBPosterior) = PosteriorDB.path(PosteriorDB.implementation(what.model, \"stan\"))\nbridgestan_model(what::PDBPosterior) = StanModel(stan_file=what.stan_file, data=what.datastring)\nunconstrained_draws(what::PDBPosterior) = (\n    bmod = what.bridgestan_model;\n    vcat([\n        param_unconstrain(bmod, collect(row))' for row in eachrow(what.constrained_draws)\n    ]...) \n)\n\n\n\"\"\"\nReparametrizations.\n\"\"\"\n@dynamic_type Reparametrization\n\n@dynamic_object ContinuousNoncentering &lt;: Reparametrization centeredness::Vector\nprevious_centeredness(what::ContinuousNoncentering) = 1\npad_left(what, ::AbstractVector) = what\npad_left(what, ::AbstractMatrix) = what'\nWarmupHMC.to_xc(xcp, mean, log_sd, target_centeredness, previous_centeredness) = to_xc(\n    to_x1(xcp, mean, log_sd, previous_centeredness),\n    mean, log_sd, target_centeredness\n)\nreparametrize(what::ContinuousNoncentering, parameters) = replace_xcs(\n    parameters,\n    to_xc.(\n        parameters.xcs, parameters.means, parameters.log_sds, \n        pad_left(what.centeredness, parameters.xcs), \n        pad_left(what.previous_centeredness, parameters.xcs)\n    )\n)\nunreparametrize(what::ContinuousNoncentering, reparameters) = replace_xcs(\n    reparameters,\n    to_xc.(\n        parameters.xcs, parameters.means, parameters.log_sds, \n        pad_left(what.previous_centeredness, parameters.xcs),\n        pad_left(what.centeredness, parameters.xcs), \n    )\n    # to_x1.(reparameters.xcs, reparameters.means, reparameters.log_sds, pad_left(what.centeredness, reparameters.xcs))\n)\nlogjacobian(what::ContinuousNoncentering, parameters, reparameters) = sum(\n    parameters.log_sds .* what.centeredness\n)\n\nlogjacobian (generic function with 1 method)\n\n\n\nes_draws = EightSchoolsDraws(PDBPosterior(\"eight_schools-eight_schools_centered\").unconstrained_draws)\n\nnc_pu = ContinuousNoncentering(zeros(8))\nnc_es_draws = reparametrize(nc_pu, es_draws)\nnc_es_draws.scatter_funnel\n\nbc_es_pu = ContinuousNoncentering(es_draws.best_centeredness)\nbc_es_draws = reparametrize(bc_es_pu, es_draws)\ndisplay(Line(1:es_draws.no_xcs, bc_es_pu.centeredness))\nFigure([\n    scatter_funnel(draws, i)\n    for i in 1:8, draws in [es_draws, nc_es_draws, bc_es_draws]\n])\n\n┌ Warning: Loading a shared object '/home/niko/.julia/artifacts/95c3074bd791a2f28857088639b48ca1b786459a/posteriordb-0.4.0/posterior_database/models/stan/eight_schools_centered_model.so' which is already loaded.\n│ If the file has changed since the last time it was loaded, this load may not update the library!\n└ @ BridgeStan /home/niko/.julia/packages/BridgeStan/ajc6B/src/model.jl:50\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmc_draws = MotorcycleDraws(PDBPosterior(\"mcycle_gp-accel_gp\").unconstrained_draws)\nc_pu = ContinuousNoncentering(ones(mc_draws.no_xcs), previous_centeredness=0) \nc_mc_draws = reparametrize(c_pu, mc_draws)\nbc_mc_pu = ContinuousNoncentering(mc_draws.best_centeredness, previous_centeredness=0)\nbc_mc_draws = reparametrize(bc_mc_pu, mc_draws)\ndisplay(Line(1:mc_draws.no_xcs, bc_mc_pu.centeredness))\n\nFigure([\n    scatter_funnel(draws, i)\n    for i in 1:mc_draws.no_xcs, draws in [mc_draws, c_mc_draws, bc_mc_draws]\n])   \n\n┌ Warning: Loading a shared object '/home/niko/.julia/artifacts/95c3074bd791a2f28857088639b48ca1b786459a/posteriordb-0.4.0/posterior_database/models/stan/accel_gp_model.so' which is already loaded.\n│ If the file has changed since the last time it was loaded, this load may not update the library!\n└ @ BridgeStan /home/niko/.julia/packages/BridgeStan/ajc6B/src/model.jl:50\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPDBPosterior(\"radon_mn-radon_hierarchical_intercept_noncentered\").bridgestan_model\n# rmn_draws = RadonHierarchicalInterceptCenteredDraws(PDBPosterior(\"radon_mn-radon_hierarchical_intercept_centered\").unconstrained_draws)\n# c_rmn_draws = reparametrize(ContinuousNoncentering(ones(rmn_draws.no_xcs)), rmn_draws)\n# bc_rmn_pu = ContinuousNoncentering(rmn_draws.best_centeredness)\n# bc_rmn_draws = reparametrize(bc_rmn_pu, rmn_draws)\n# display(Line(1:rmn_draws.no_xcs, bc_rmn_pu.centeredness))\n\n# Figure([\n#     scatter_funnel(draws, i)\n#     for i in 1:rmn_draws.no_xcs, draws in [rmn_draws, c_rmn_draws, bc_rmn_draws]\n# ])   \n\n┌ Warning: Loading a shared object '/home/niko/.julia/artifacts/95c3074bd791a2f28857088639b48ca1b786459a/posteriordb-0.4.0/posterior_database/models/stan/radon_hierarchical_intercept_noncentered_model.so' which is already loaded.\n│ If the file has changed since the last time it was loaded, this load may not update the library!\n└ @ BridgeStan /home/niko/.julia/packages/BridgeStan/ajc6B/src/model.jl:50\n\n\nStanModel(Ptr{Nothing} @0x000000000a395f60, Ptr{BridgeStan.StanModelStruct} @0x000000000ffe3d10, \"{\\n  \\\"N\\\": 919,\\n  \\\"J\\\": 85,\\n  \\\"floor_measure\\\": [0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],\\n  \\\"log_radon\\\": [0.0953101798043249, 0.832909122935104, 1.09861228866811, 0.832909122935104, 0.0953101798043249, 1.09861228866811, 1.22377543162212, 0.182321556793955, 0.955511445027436, 0.262364264467491, 0.693147180559945, 0.832909122935104, 0.336472236621213, 0.182321556793955, 0.470003629245736, 1.52605630349505, 0.641853886172395, 1.16315080980568, 1.85629799036563, 1.22377543162212, 0.405465108108164, 0.587786664902119, -0.693147180559945, 1.96009478404727, 2.05412373369555, 1.66770682055808, 1.52605630349505, 0.916290731874155, 1.06471073699243, 2.10413415427021, -0.22314355131421, 1.45861502269952, 1.09861228866811, 0.336472236621213, 1.16315080980568, 1.09861228866811, 0.405465108108164, 0.405465108108164, 0.641853886172395, -1.20397280432594, 1.79175946922805, 1.50407739677627, 1.41098697371026, 0.78845736036427, 1.70474809223843, 1.93152141160321, 0.587786664902119, 0.832909122935104, 0.262364264467491, 0.641853886172395, -0.356674943938732, 1.90210752639692, 0.53062825106217, 0.693147180559945, 1.70474809223843, 0.8754687373539, 0.262364264467491, 1.48160454092422, 1.52605630349505, 1.50407739677627, 1.54756250871601, -0.693147180559945, 1.75785791755237, 1.54756250871601, 1.85629799036563, 0.832909122935104, 1.90210752639692, 1.09861228866811, 1.09861228866811, 1.02961941718116, 1.62924053973028, 0.993251773010283, 1.98787434815435, 1.62924053973028, 0.641853886172395, 2.26176309847379, 1.56861591791385, 1.3609765531356, 2.55722731136763, 1.98787434815435, 1.94591014905531, 2.57261223020711, 1.77495235091167, 2.66722820658195, 1.80828877117927, 2.26176309847379, 1.93152141160321, 0.955511445027436, 1.91692261218206, 1.41098697371026, 2.32238772029023, 1.7404661748405, 1.48160454092422, 0.336472236621213, 0.641853886172395, 1.45861502269952, 0.741937344729377, 1.38629436111989, -0.105360515657826, 1.25276296849537, 0.832909122935104, 2.27212588550934, -2.30258509299405, 1.56861591791385, 0.53062825106217, 2.69462718077007, 2.56494935746154, 1.33500106673234, 1.41098697371026, 0.693147180559945, 1.68639895357023, 2.01490302054226, 2.05412373369555, 2.31253542384721, 0.405465108108164, 2.2512917986065, -0.105360515657826, 0.587786664902119, 2.10413415427021, 0.78845736036427, 1.62924053973028, 1.50407739677627, 2.2082744135228, 1.94591014905531, 3.2846635654062, 2.97552956623647, 2.56494935746154, 2.57261223020711, 0.993251773010283, 1.28093384546206, 2.58021682959233, 0, 0.470003629245736, 0.955511445027436, 2.18605127673809, 1.30833281965018, 1.25276296849537, 0, 1.58923520511658, 1.25276296849537, 0.405465108108164, 1.02961941718116, 2.41591377830105, -2.30258509299405, 0.955511445027436, 1.93152141160321, 1.50407739677627, 1.48160454092422, 0.53062825106217, 1.91692261218206, 1.43508452528932, 0.470003629245736, 0, 1.09861228866811, 0.955511445027436, 0.641853886172395, 0.0953101798043249, 1.7227665977411, 2.68784749378469, 0.741937344729377, 1.06471073699243, 2.21920348405499, 0.741937344729377, 1.45861502269952, 0.955511445027436, 1.91692261218206, 1.30833281965018, 0.993251773010283, 1.06471073699243, 1.56861591791385, 1.50407739677627, 0.405465108108164, 1.30833281965018, 1.25276296849537, 3.05870707271538, 0.405465108108164, 0.587786664902119, 2.27212588550934, 0.182321556793955, 2.09186406167839, 1.70474809223843, 1.28093384546206, 1.64865862558738, 1.88706964903238, 1.19392246847243, 1.22377543162212, 2.11625551480255, 1.50407739677627, 1.52605630349505, 1.6094379124341, 1.58923520511658, 0, 2.04122032885964, 1.62924053973028, 0.53062825106217, 1.58923520511658, 0.405465108108164, 0.587786664902119, 1.6094379124341, 2.3887627892351, 1.50407739677627, 1.48160454092422, 0.182321556793955, 1.85629799036563, 0.470003629245736, 1.77495235091167, 0.8754687373539, 2.10413415427021, 0.693147180559945, 1.06471073699243, -0.105360515657826, 1.54756250871601, 1.3609765531356, 2.17475172148416, 1.80828877117927, 1.93152141160321, 2.18605127673809, 0.405465108108164, 0.832909122935104, 2.18605127673809, -0.510825623765991, 1.70474809223843, 1.75785791755237, 1.98787434815435, 1.93152141160321, 2.06686275947298, 1.58923520511658, 1.50407739677627, 1.7227665977411, 1.02961941718116, 2.01490302054226, 1.87180217690159, 1.33500106673234, 0.8754687373539, 1.45861502269952, 0.336472236621213, -1.6094379124341, 1.25276296849537, 1.66770682055808, 1.19392246847243, 0.955511445027436, 1.7404661748405, 1.45861502269952, 2.58776403522771, 2.27212588550934, 0.832909122935104, 1.85629799036563, 2.2082744135228, 1.19392246847243, 3.48737507790321, 1.58923520511658, 3.77505715035499, 0.993251773010283, 1.28093384546206, 1.91692261218206, 1.38629436111989, 1.94591014905531, 2.66722820658195, 2.04122032885964, 1.7404661748405, 1.6094379124341, 1.28093384546206, 2.29253475714054, 1.6094379124341, 0.955511445027436, 1.38629436111989, 1.3609765531356, -0.693147180559945, 0, 1.7227665977411, 1.43508452528932, 1.19392246847243, 1.02961941718116, 2.01490302054226, 1.7404661748405, 2.57261223020711, 1.06471073699243, 1.02961941718116, 1.80828877117927, 0.336472236621213, 2.16332302566054, 1.09861228866811, 1.75785791755237, 1.56861591791385, 1.41098697371026, 0.641853886172395, 1.45861502269952, 1.38629436111989, 0.8754687373539, 1.7227665977411, 2.04122032885964, 1.50407739677627, 1.70474809223843, 1.84054963339749, 1.22377543162212, 0.587786664902119, 0.53062825106217, 1.1314021114911, 0.641853886172395, 0.955511445027436, 2.16332302566054, 0.993251773010283, 2.70805020110221, 0.955511445027436, 0.993251773010283, 0.741937344729377, 1.54756250871601, 0.470003629245736, 1.1314021114911, 2.16332302566054, 1.7404661748405, 1.43508452528932, 1.1314021114911, -0.22314355131421, 1.56861591791385, 0.955511445027436, 1.98787434815435, 1.09861228866811, 2.14006616349627, 1.06471073699243, 2.07944154167984, 1.22377543162212, 0.78845736036427, 1.06471073699243, 1.79175946922805, 0.53062825106217, 1.3609765531356, 2.42480272571829, 1.22377543162212, 1.7404661748405, -0.693147180559945, 1.75785791755237, -0.105360515657826, 1.30833281965018, 3.16547504814109, 1.48160454092422, 1.09861228866811, 1.64865862558738, 0.832909122935104, 1.80828877117927, 1.41098697371026, 1.7227665977411, 1.1314021114911, 2.63188884013665, 1.48160454092422, 2.04122032885964, 0.78845736036427, 2.04122032885964, 2.8094026953625, 1.52605630349505, 1.38629436111989, 1.6094379124341, 2.39789527279837, 0, 1.7227665977411, 0.693147180559945, 0.53062825106217, 1.54756250871601, 1.56861591791385, 1.1314021114911, 0.993251773010283, 1.54756250871601, 0.641853886172395, 1.38629436111989, 1.38629436111989, 0.470003629245736, 1.48160454092422, 1.16315080980568, 0.916290731874155, 1.30833281965018, 2.15176220325946, 2.2082744135228, 1.25276296849537, 1.58923520511658, 0.832909122935104, 1.54756250871601, 1.06471073699243, 1.33500106673234, 0.470003629245736, -0.105360515657826, 1.1314021114911, 1.30833281965018, 0.832909122935104, 1.48160454092422, 0.955511445027436, 0.916290731874155, 0.641853886172395, 0.693147180559945, 1.22377543162212, 0.182321556793955, 2.2512917986065, 0.336472236621213, 0.993251773010283, 0.993251773010283, 2.14006616349627, 2.73436750941958, 2.58021682959233, 1.62924053973028, 1.09861228866811, 1.3609765531356, 0.993251773010283, 2.07944154167984, 0.641853886172395, 1.43508452528932, 2.51769647261099, 1.91692261218206, 2.43361335540045, 1.94591014905531, 0, 1.52605630349505, 0.587786664902119, 0.0953101798043249, 0.0953101798043249, 0.405465108108164, 0.336472236621213, 1.06471073699243, 0.741937344729377, 2.43361335540045, 2.77881927199042, -0.510825623765991, -0.510825623765991, 0.336472236621213, 0.53062825106217, 0.336472236621213, 0.470003629245736, 1.97408102602201, 1.06471073699243, 0, 2.32238772029023, 1.48160454092422, 1.09861228866811, 1.22377543162212, 1.45861502269952, 2.53369681395743, 1.38629436111989, 1.52605630349505, 1.22377543162212, 2.07944154167984, 2.37024374146786, 2.86789890204411, 1.28093384546206, 2.19722457733622, 2.4932054526027, 1.64865862558738, 1.94591014905531, 1.54756250871601, 1.64865862558738, 1.88706964903238, 1.77495235091167, 0.641853886172395, 0.262364264467491, 1.50407739677627, 0.8754687373539, -2.30258509299405, 1.06471073699243, 2.37024374146786, 2.30258509299405, 3.23867845216438, 1.38629436111989, 2.34180580614733, 0.182321556793955, 0.53062825106217, 1.38629436111989, 1.06471073699243, 0, 0.405465108108164, 0.182321556793955, 0.470003629245736, 2.12823170584927, 3.87743156065853, 0, 3.17387845893747, 2.02814824729229, 2.23001440015921, 1.91692261218206, -0.510825623765991, 0.470003629245736, -0.510825623765991, 1.43508452528932, 1.19392246847243, 0.8754687373539, 1.98787434815435, 1.38629436111989, 0.78845736036427, -0.510825623765991, 1.75785791755237, 0.405465108108164, 1.1314021114911, 1.38629436111989, 0.78845736036427, 1.1314021114911, 1.50407739677627, 1.6094379124341, 1.06471073699243, 0.916290731874155, 0.741937344729377, 2.39789527279837, 1.52605630349505, 0.336472236621213, 2.23001440015921, 1.87180217690159, 0.182321556793955, 2.21920348405499, 1.1314021114911, 2.37024374146786, 2.09186406167839, 0.78845736036427, 3.18221184049661, 2.50143595173921, 2.10413415427021, 1.45861502269952, 2.76000994003292, 2.3887627892351, 1.84054963339749, 1.70474809223843, 2.28238238567653, 2.10413415427021, 0.53062825106217, 0.53062825106217, 2.42480272571829, 1.62924053973028, 0.587786664902119, 0.8754687373539, 0.182321556793955, 1.43508452528932, 2.09186406167839, 0.78845736036427, 1.50407739677627, 1.3609765531356, 1.19392246847243, 0.741937344729377, 2.2512917986065, 1.09861228866811, 1.52605630349505, 2.31253542384721, 1.09861228866811, 0.955511445027436, 0.955511445027436, -0.356674943938732, 1.87180217690159, 0.182321556793955, 2.06686275947298, 1.19392246847243, 2.4932054526027, 1.02961941718116, 2.54160199346455, 1.45861502269952, 0.182321556793955, 0.78845736036427, 1.3609765531356, 1.33500106673234, -0.916290731874155, 1.77495235091167, 0.262364264467491, 0.693147180559945, 0.262364264467491, 0.470003629245736, 1.43508452528932, 1.06471073699243, 1.48160454092422, 2.50143595173921, 2.2512917986065, 0.587786664902119, 0.955511445027436, 2.27212588550934, 0.405465108108164, 1.94591014905531, 1.25276296849537, 1.3609765531356, 1.28093384546206, 1.30833281965018, 1.41098697371026, 1.96009478404727, 1.6094379124341, 1.7227665977411, 1.45861502269952, 0.53062825106217, 0.0953101798043249, 1.93152141160321, 1.02961941718116, 1.02961941718116, 0.262364264467491, 1.3609765531356, 0.78845736036427, 1.84054963339749, 1.28093384546206, 1.16315080980568, 0.262364264467491, 1.28093384546206, 1.66770682055808, 2.32238772029023, 0.262364264467491, 1.06471073699243, 0.832909122935104, 0.955511445027436, 1.7227665977411, -0.22314355131421, 2.16332302566054, 0.993251773010283, 0.262364264467491, 0.587786664902119, 3.03495298670727, 1.3609765531356, 2.01490302054226, 2.19722457733622, 0.693147180559945, 1.77495235091167, 0.78845736036427, 1.80828877117927, 1.56861591791385, 1.87180217690159, 2.10413415427021, 2.94968833505258, 2.05412373369555, 1.54756250871601, 1.7404661748405, 0.916290731874155, 2.28238238567653, 1.64865862558738, 1.1314021114911, 2.14006616349627, 0.53062825106217, 1.02961941718116, 1.45861502269952, 1.30833281965018, 1.30833281965018, 1.16315080980568, 1.48160454092422, 1.80828877117927, 1.25276296849537, 2.4423470353692, 0.587786664902119, 0.262364264467491, 1.41098697371026, 0.182321556793955, 2.34180580614733, 0.741937344729377, 0.641853886172395, 0.641853886172395, 1.87180217690159, 1.02961941718116, 1.1314021114911, 0.641853886172395, 0, 0.741937344729377, 1.16315080980568, -0.22314355131421, 0.53062825106217, 1.22377543162212, 0.587786664902119, -0.105360515657826, 0.741937344729377, 0.405465108108164, 0.405465108108164, 0.641853886172395, 1.22377543162212, -0.510825623765991, 0.916290731874155, 1.02961941718116, 0.587786664902119, 0, 1.22377543162212, -1.20397280432594, 0.832909122935104, 0.78845736036427, 0.405465108108164, -0.22314355131421, 1.45861502269952, 0.470003629245736, 0.78845736036427, 1.09861228866811, 0.641853886172395, 0.470003629245736, 0.182321556793955, 0.832909122935104, 1.48160454092422, 1.22377543162212, 0, -0.356674943938732, 1.25276296849537, 0, 1.70474809223843, 0.470003629245736, -0.105360515657826, 0.916290731874155, 0.916290731874155, 0.8754687373539, 1.54756250871601, 1.16315080980568, -0.22314355131421, 1.48160454092422, 1.52605630349505, 0.470003629245736, 1.38629436111989, 0.832909122935104, 0.53062825106217, 2.17475172148416, 0.53062825106217, 0.405465108108164, 0.641853886172395, 2.41591377830105, 0.470003629245736, 1.54756250871601, 1.70474809223843, 0.182321556793955, 1.30833281965018, 1.98787434815435, 0.182321556793955, 1.19392246847243, 1.22377543162212, 1.30833281965018, 0.587786664902119, -0.105360515657826, 2.46809953147162, 1.06471073699243, 1.28093384546206, -0.105360515657826, 0.693147180559945, 1.1314021114911, 0.641853886172395, 1.16315080980568, 0.405465108108164, 0.587786664902119, 1.7404661748405, 1.25276296849537, 0.470003629245736, 2.40694510831829, 2.70805020110221, 0.78845736036427, 0.470003629245736, 0.336472236621213, 0, 1.98787434815435, 0.336472236621213, 0.470003629245736, 2.17475172148416, 0.8754687373539, 0.916290731874155, 0.182321556793955, 0.262364264467491, 2.16332302566054, 0.641853886172395, -0.510825623765991, 1.28093384546206, 1.19392246847243, 0.641853886172395, -0.510825623765991, 0.182321556793955, -0.693147180559945, 3.47506723022861, 1.16315080980568, 1.62924053973028, 0.78845736036427, 2.33214389523559, 0.741937344729377, 2.96527306606928, 2.4423470353692, 0.741937344729377, 2.21920348405499, 1.19392246847243, 0.262364264467491, 0.832909122935104, 3.23080439573347, 1.70474809223843, 1.48160454092422, 1.06471073699243, 0.53062825106217, 0.8754687373539, 1.16315080980568, 1.56861591791385, 1.64865862558738, 1.19392246847243, 0.955511445027436, 0.470003629245736, 1.58923520511658, 1.41098697371026, 1.62924053973028, 0.336472236621213, 2.01490302054226, 0.832909122935104, 1.87180217690159, 2.02814824729229, 0.78845736036427, 1.22377543162212, 1.62924053973028, 1.90210752639692, 2.01490302054226, 2.68102152871429, 2.12823170584927, 1.62924053973028, 0.693147180559945, 1.96009478404727, 1.33500106673234, 2.32238772029023, 0.993251773010283, 1.75785791755237, 1.62924053973028, 0.0953101798043249, 1.22377543162212, 0.993251773010283, 0.470003629245736, 0.641853886172395, 1.64865862558738, 2.16332302566054, 2.00148000021012, 1.09861228866811, 2.14006616349627, 0.470003629245736, 1.30833281965018, 1.33500106673234, 1.50407739677627, 2.37024374146786, 1.52605630349505, 2.09186406167839, 0.470003629245736, 1.1314021114911, 1.58923520511658, 0.916290731874155, 1.93152141160321, 0.78845736036427, 1.80828877117927, 1.91692261218206, 1.09861228866811, 1.41098697371026, 2.96527306606928, 2.27212588550934, 1.79175946922805, 2.45100509811232, 1.16315080980568, 2.2082744135228, 2.14006616349627, 0.182321556793955, -0.22314355131421, 1.56861591791385, 1.58923520511658, 1.19392246847243, 1.09861228866811, 2.24070968927596, 0, 0.587786664902119, -0.693147180559945, 3.02042488614436, 1.54756250871601, 1.90210752639692, 0.832909122935104, 0.336472236621213, 0.916290731874155, 1.80828877117927, 1.84054963339749, 0.587786664902119, 2.05412373369555, 1.88706964903238, 0.262364264467491, 1.06471073699243, 1.56861591791385, 0.693147180559945, 0.641853886172395, 0.262364264467491, 0.53062825106217, -0.105360515657826, 0.587786664902119, 2.50959926237837, 2.37954613413017, 0.916290731874155, -0.105360515657826, 0.693147180559945, 1.68639895357023, 2.60268968544438, 1.48160454092422, 0.0953101798043249, 0.641853886172395, 0.470003629245736, 2.33214389523559, 0.78845736036427, 1.88706964903238, 0.955511445027436, 1.3609765531356, 1.09861228866811, 1.22377543162212, 2.29253475714054, 1.33500106673234, 1.79175946922805, 2.15176220325946, 1.90210752639692, 1.3609765531356, 1.56861591791385, 1.6094379124341, 1.75785791755237, 2.63188884013665, 2.33214389523559, 2.24070968927596, -0.510825623765991, 2.45958884180371, 1.56861591791385, 1.98787434815435, 1.56861591791385, 1.25276296849537, -0.22314355131421, 2.04122032885964, 0.641853886172395, 2.47653840011748, 2.33214389523559, 2.43361335540045, 1.43508452528932, 1.62924053973028, 1.87180217690159, 1.16315080980568, 1.68639895357023, 1.52605630349505, 0.8754687373539, 1.64865862558738, 2.00148000021012, 0.832909122935104, 0.78845736036427, 2.26176309847379, 2.77258872223978, 1.91692261218206, 1.09861228866811, 1.33500106673234],\\n  \\\"log_uppm\\\": [-0.507408136699532, -0.507408136699532, -0.507408136699532, -0.507408136699532, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.637589491641256, -0.00728547473838742, -0.00728547473838742, -0.00728547473838742, -0.426987052583424, -0.426987052583424, -0.426987052583424, -0.426987052583424, -0.426987052583424, -0.426987052583424, -0.426987052583424, -0.0337129487726719, -0.0337129487726719, -0.0337129487726719, -0.0337129487726719, 0.452755735836182, 0.452755735836182, 0.452755735836182, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.345063794689886, 0.350607574623445, 0.350607574623445, 0.350607574623445, 0.350607574623445, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, -0.201796773694768, 0.182829760969667, 0.182829760969667, 0.182829760969667, 0.182829760969667, 0.182829760969667, 0.182829760969667, -0.439561333904037, -0.439561333904037, -0.439561333904037, -0.439561333904037, -0.439561333904037, 0.346988178349189, 0.346988178349189, 0.346988178349189, 0.346988178349189, -0.54584504140038, -0.54584504140038, -0.54584504140038, -0.54584504140038, -0.54584504140038, -0.54584504140038, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.412288442789617, 0.0410421302885988, 0.0410421302885988, 0.0410421302885988, 0.0410421302885988, -0.351676030779486, -0.351676030779486, 0.408347616353338, 0.408347616353338, 0.408347616353338, 0.408347616353338, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, -0.460783862219048, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.073384281781574, 0.337856991690917, 0.337856991690917, 0.337856991690917, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.237827216699362, 0.366835153755869, 0.366835153755869, 0.366835153755869, 0.366835153755869, 0.366835153755869, 0.366835153755869, 0.478864257677932, 0.478864257677932, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.3010892926591, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.275561413138703, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.00795924103788845, 0.562212413782689, 0.562212413782689, 0.562212413782689, 0.562212413782689, 0.562212413782689, 0.562212413782689, -0.261468665635878, -0.261468665635878, -0.261468665635878, -0.261468665635878, -0.261468665635878, -0.559520542471416, -0.559520542471416, -0.559520542471416, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, -0.485931405483152, 0.379866918940402, 0.379866918940402, 0.379866918940402, 0.379866918940402, 0.379866918940402, 0.0468969445882487, 0.0468969445882487, 0.0468969445882487, 0.0468969445882487, 0.195550336040295, 0.195550336040295, 0.195550336040295, 0.195550336040295, 0.0882187311774796, 0.0882187311774796, 0.0882187311774796, -0.665483376577472, -0.665483376577472, -0.665483376577472, -0.665483376577472, -0.665483376577472, -0.665483376577472, -0.665483376577472, 0.381739194780127, 0.381739194780127, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.509533126067787, -0.501284617598835, -0.501284617598835, -0.501284617598835, -0.501284617598835, 0.273562863890897, 0.273562863890897, 0.273562863890897, 0.273562863890897, 0.273562863890897, 0.507022400672956, 0.507022400672956, 0.507022400672956, 0.507022400672956, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.459946980240993, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.223751366557094, 0.232198431866447, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.107831460357997, 0.247180339142429, 0.247180339142429, 0.247180339142429, 0.247180339142429, 0.247180339142429, 0.247180339142429, 0.247180339142429, 0.117107251810353, 0.117107251810353, 0.117107251810353, 0.117107251810353, 0.117107251810353, -0.093721841881117, -0.093721841881117, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.0109270813997772, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.335142781859153, 0.463803196229086, 0.323184342294278, 0.323184342294278, 0.323184342294278, 0.323184342294278, 0.46999112916761, 0.46999112916761, 0.46999112916761, 0.339125855515343, 0.339125855515343, 0.339125855515343, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, 0.318642804152193, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, -0.0889765794629622, 0.0282433743386983, 0.0282433743386983, 0.0282433743386983, -0.0519851125859529, -0.0519851125859529, -0.0519851125859529, -0.0519851125859529, -0.0519851125859529, -0.0519851125859529, 0.538724797157947, 0.538724797157947, 0.538724797157947, 0.538724797157947, 0.339951889885462, 0.339951889885462, 0.339951889885462, 0.339951889885462, 0.353926169517459, 0.353926169517459, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, -0.276640587948423, 0.433352611595055, 0.433352611595055, 0.433352611595055, 0.433352611595055, 0.433352611595055, 0.446690221365142, 0.446690221365142, 0.446690221365142, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.272360291153969, 0.585328089525448, 0.585328089525448, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.0954893958625634, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, -0.325608263860011, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, 0.15284983409421, -0.502726840953963, -0.502726840953963, -0.502726840953963, -0.502726840953963, -0.502726840953963, -0.502726840953963, -0.502726840953963, -0.502726840953963, 0.313137808423569, 0.313137808423569, 0.313137808423569, 0.313137808423569, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.201666563057731, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.343384009477464, 0.531357396935404, 0.531357396935404, 0.386397810390911, 0.386397810390911, 0.386397810390911, 0.386397810390911, 0.0528201281833728, 0.0528201281833728, 0.0528201281833728, 0.556617010378854, 0.556617010378854, 0.556617010378854, 0.556617010378854, 0.232642295068756, 0.232642295068756, 0.232642295068756, 0.232642295068756, 0.232642295068756, 0.232642295068756, 0.232642295068756, -0.493196926371479, -0.493196926371479, -0.493196926371479, -0.493196926371479, -0.493196926371479, 0.290173965106758, 0.290173965106758, 0.290173965106758, 0.290173965106758, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, -0.0378306397531399, 0.263210060527293, 0.263210060527293, 0.263210060527293, 0.312047802353535, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.524237284033606, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.0138131575520509, 0.42303648985639, 0.42303648985639],\\n  \\\"county_idx\\\": [1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 32, 32, 32, 32, 33, 33, 33, 33, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 36, 36, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38, 38, 39, 39, 39, 39, 39, 40, 40, 40, 40, 41, 41, 41, 41, 41, 41, 41, 41, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 42, 43, 43, 43, 43, 43, 43, 43, 43, 43, 44, 44, 44, 44, 44, 44, 44, 46, 46, 46, 46, 46, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 52, 52, 52, 53, 53, 53, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 59, 60, 60, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 62, 62, 62, 62, 62, 63, 63, 63, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 65, 65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 68, 68, 68, 68, 68, 68, 68, 68, 69, 69, 69, 69, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 73, 73, 74, 74, 74, 74, 75, 75, 75, 76, 76, 76, 76, 77, 77, 77, 77, 77, 77, 77, 78, 78, 78, 78, 78, 79, 79, 79, 79, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 81, 81, 81, 82, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 85, 85]\\n}\\n\", 0x000000cc, 0x00000000)"
  },
  {
    "objectID": "independent.html",
    "href": "independent.html",
    "title": "Using independent draws",
    "section": "",
    "text": "using DynamicObjects, WarmupHMC\nusing Distributions, Statistics, LinearAlgebra, ForwardDiff\nusing Plots\n\n@dynamic_object WarmupWindow no_iterations::Integer type\n \n@dynamic_object StanWarmup no_iterations::Number adaptation=:metric\nwarmup_windows(what::StanWarmup) = [\n  WarmupWindow(75, :scale)\n  WarmupWindow(25, what.adaptation)\n  WarmupWindow(50, what.adaptation)\n  WarmupWindow(100, what.adaptation)\n  WarmupWindow(200, what.adaptation)\n  WarmupWindow(500, what.adaptation)\n  WarmupWindow(50, :scale)\n]\n\nDistributions.logpdf(what::DynamicObject, parameters) = logpdf(what.distribution, parameters)\nno_dimensions(what::DynamicObject) = length(what.distribution)\nlogpdf_gradient(what::DynamicObject, parameters) = ForwardDiff.gradient(\n  theta-&gt;logpdf(what, theta), parameters\n)\n\n@dynamic_object IndependentKernel distribution::Distribution\n@dynamic_object IndependentKernel distribution::DynamicObject\ntransition(what::IndependentKernel, last) = rand(what.distribution)\n\n@dynamic_object Warmup kernel procedure\n# no_dimensions(what::Warmup) = length(what.kernel.distribution)\nwarmup_windows(what::Warmup) = what.procedure.warmup_windows\ncovariance(what::DynamicObject) = cov(what.distribution)\ncovariance_estimate(what::DynamicObject) = LinearAlgebra.I \nfunction covariance_remaining(what::DynamicObject)\n  ce = what.covariance_estimate\n  L = isa(ce, UniformScaling) ? I : cholesky(ce).L\n  return L \\ what.covariance / L'\nend\nfunction kernels(what::Warmup)\n  current_kernel = what.kernel\n  rv = [current_kernel]\n  fig = missing\n\n  no_dimensions = current_kernel.no_dimensions\n  current_parameters = zeros(no_dimensions)\n\n  for window in what.warmup_windows\n    samples = zeros((window.no_iterations, no_dimensions))\n    gradients = zeros((window.no_iterations, no_dimensions))\n    for iteration in 1:window.no_iterations\n      current_parameters .= transition(current_kernel, current_parameters)\n      samples[iteration, :] .= current_parameters\n      gradients[iteration, :] .= logpdf_gradient(current_kernel, current_parameters)\n    end\n    scov = cov(samples)\n    gcov = cov(gradients)\n    if window.type == :metric\n      # covariance_estimate = regularize(Symmetric(scov), window.no_iterations)\n      covariance_estimate = regularize(Diagonal(sqrt.(diag(scov) ./ diag(gcov))), window.no_iterations)\n      current_kernel = DynamicObjects.update(\n        current_kernel, covariance_estimate=covariance_estimate\n      )\n      push!(rv, current_kernel)\n    end\n    if window.type == :parametrization\n      ismissing(fig) && (fig = vline(current_kernel.distribution.centeredness[1:1], ylim=[0,1]))\n      # klps_plot!(\n      #   fig, \n      #   [x1s(current_kernel.distribution, parameters)[1] for parameters in eachrow(samples)],\n      #   [log_sds(current_kernel.distribution, parameters)[1] for parameters in eachrow(samples)]\n      # )\n      # cs = LinRange(0, 1, 100)\n      # x1 = [x1s(current_kernel.distribution, parameters)[1] for parameters in eachrow(samples)]\n      # sd = [sds(current_kernel.distribution, parameters)[1] for parameters in eachrow(samples)]\n      # # x1, sd = samples[:, 2], samples[:, 1]\n      # kl1s = [klp(x1, log.(sd), c) for c in cs]\n      # kl1s .-= minimum(kl1s)\n      # kl1s ./= maximum(kl1s)\n      # plot!(fig, cs, kl1s)\n      push!(rv, current_kernel)\n    end\n  end\n  !ismissing(fig) && display(fig)\n  return rv\nend\n\nshowcase(no_dimensions::Integer=10) = showcase(\n  MvNormal(randn(no_dimensions), Diagonal(exp.(randn(no_dimensions))))\n)\nfunction showcase(distribution, adaptation=:metric)\n  sw = StanWarmup(1000, adaptation)\n  ikernels = Warmup(IndependentKernel(distribution), sw).kernels\n  iconds = cond.(covariance_remaining.(ikernels))\n  conds = iconds\n  plot(\n    [iconds], yaxis=:log, ylim=[1, maximum(conds)], marker=:circle\n  )\nend\nshowcase()\n\n\n\n\n\n\"\"\"\nNeal's funnel with a twist!\n\"\"\"\n@dynamic_object NealsFunnel centeredness::Vector\nno_dimensions(what::NealsFunnel) = 1+length(what.centeredness)\nBase.length(what::NealsFunnel) = what.no_dimensions\ncenteredness_estimate(what::NealsFunnel) = ones(length(what.centeredness))\ncenteredness_remaining(what::NealsFunnel) = what.centeredness - what.centeredness_estimate\nStatistics.cov(what::NealsFunnel) = LinearAlgebra.I\nlog_sds(what::NealsFunnel, parameters) = exp(parameters[1])\nx1s(what::NealsFunnel, parameters) = parameters[2:end]\nfunction Distributions.logpdf(what::NealsFunnel, parameters) \n  log_sd = parameters[1]\n  sd = exp(log_sd)\n  logpdf(Normal(), log_sd) + sum(logpdf.(Normal.(0, sd.^-what.centeredness_remaining), parameters[2:end]))\nend\nfunction Base.rand(what::NealsFunnel)\n  xis = randn(what.no_dimensions)\n  log_sd = xis[1]\n  sd = exp(log_sd)\n  return vcat(log_sd, sd.^-what.centeredness_remaining .* xis[2:end])\nend\n\nshowcase(NealsFunnel(rand(5)), :parametrization)\n\n\n\n\n\n\n\n\n\"\"\"\nA distribution which looks a bit like an HSGP posterior!\n\"\"\"\n@dynamic_object HSGP centeredness::Vector L=1.5\nno_basis_functions(what::HSGP) = length(what.centeredness)\nindices(what::HSGP) = 1:what.no_basis_functions\nno_dimensions(what::HSGP) = 2+what.no_basis_functions\nBase.length(what::HSGP) = what.no_dimensions\ncenteredness_estimate(what::HSGP) = ones(what.no_basis_functions)\ncenteredness_remaining(what::HSGP) = what.centeredness - what.centeredness_estimate\nStatistics.cov(what::HSGP) = LinearAlgebra.I\n# https://github.com/avehtari/casestudies/blob/master/Birthdays/gpbasisfun_functions.stan\n# alpha * sqrt(sqrt(2*pi()) * rho) * exp(-0.25*(rho*pi()/2/L)^2 * linspaced_vector(M, 1, M)^2)\nfunction sds(what::HSGP, parameters) \n  sd, lengthscale = exp.(parameters[1:2])\n  sd .* sqrt.(sqrt(2pi*lengthscale) .* exp.(-(lengthscale*pi/4/what.L)^2 .* what.indices))\nend\nlog_sds(what::HSGP, parameters) = log.(sds(what, parameters))\nx1s(what::HSGP, parameters) = parameters[3:end]\nfunction Distributions.logpdf(what::HSGP, parameters) \n  log_sd, log_lengthscale = parameters[1:2]\n  sd, lengthscale = exp.([log_sd, log_lengthscale])\n  sum(\n    logpdf.(Normal(), [log_sd, log_lengthscale])\n  ) + sum(\n    logpdf.(Normal.(0, sds(what, parameters).^-what.centeredness_remaining), parameters[3:end])\n  )\nend\nfunction Base.rand(what::HSGP)\n  xis = randn(what.no_dimensions)\n  log_sd, log_lengthscale = xis[1:2]\n  return vcat(log_sd, log_lengthscale, sds(what, parameters).^-what.centeredness_remaining .* xis[3:end])\nend\n\nshowcase(NealsFunnel(rand(5)), :parametrization)"
  }
]