<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nikolas Siccha">

<title>Adaptive warm-up for linear and non-linear transformations – WarmupHMC.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2c46d8c8cf1c501c791ade97b9c7710a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css">
<script src="datatables.min.js"></script>
<script>
  $(document).ready( function () {
      $('table.interactive').DataTable({paging: false, order=[]});
  } );
</script>

</head><body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">WarmupHMC.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nsiccha/WarmupHMC.jl"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#method-code" id="toc-method-code" class="nav-link active" data-scroll-target="#method-code">Method &amp; code</a>
  <ul class="collapse">
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  <li><a href="#code-adaptive_warmup_mcmc.jl" id="toc-code-adaptive_warmup_mcmc.jl" class="nav-link" data-scroll-target="#code-adaptive_warmup_mcmc.jl">Code: <code>adaptive_warmup_mcmc.jl</code></a></li>
  </ul></li>
  <li><a href="#sampling-efficiency-comparison-linear-transformations" id="toc-sampling-efficiency-comparison-linear-transformations" class="nav-link" data-scroll-target="#sampling-efficiency-comparison-linear-transformations">Sampling efficiency comparison: linear transformations</a></li>
  <li><a href="#sampling-efficiency-comparison-non-linear-transformations" id="toc-sampling-efficiency-comparison-non-linear-transformations" class="nav-link" data-scroll-target="#sampling-efficiency-comparison-non-linear-transformations">Sampling efficiency comparison: non-linear transformations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Adaptive warm-up for linear and non-linear transformations</h1>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nikolas Siccha </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>A previous approach to do automatic non-linear reparametrizations using MCMC draws has been found lacking, AFAICT mainly for two reasons:</p>
<ul>
<li><strong>High start-up cost</strong>: Especially in the early stages of warm-up, a lot of effort is spent to get just a handful of MCMC draws. These are usually strongly correlated, and are thus usually less than helpful in learning the linear transformation, and even less so for the non-linear transformation.</li>
<li><strong>Limited convergence due to statistical “fluctuations”</strong>: Even in the later stages of warm-up, the number of MCMC draws will inherently be limited. If there are many linear and non-linear parameters that have to be learned, the inherent fluctuations in estimating the “ideal” parameters may be so large that the linear and/or non-linear transformation are not helpful. Aiming e.g.&nbsp;for <a href="https://mc-stan.org/docs/reference-manual/mcmc.html#automatic-parameter-tuning">Stan’s default final 500 warm-up draws</a> will still generally lead to large sampling distributions of the “ideal” parameters, while VI methods employing SGD-type optimizers have a potentially limitless sample size in estimating the ideal parameters.</li>
</ul>
<section id="method-code" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="method-code">Method &amp; code</h2>
<section id="method" class="level3">
<h3 class="anchored" data-anchor-id="method">Method</h3>
<p>Working on an explanation, but see also the commented code below which includes an explanation in the docstring at the top. The docstring is also reproduced below:</p>
<p>Adaptively learn</p>
<ul>
<li>a (currently only) linear transformation of the posterior that simplifies MCMC sampling,</li>
<li>a NUTS step size (using standard Dual Averaging) and return samples from the posterior.</li>
</ul>
<p>The warm-up procedure is windowed and somehow insipred by <a href="https://mc-stan.org/docs/reference-manual/mcmc.html#automatic-parameter-tuning">Stan</a>’s and <a href="https://github.com/pymc-devs/nutpie">nutpie</a>’s warm-up procedures, but differs in several important ways:</p>
<ul>
<li>We initialize using Pathfinder!</li>
<li>Our warm-up windows aim to reach a certain number of GRADIENT EVALUATIONS , instead of a certain number of MCMC transitions (Stan). We start with a (default) target of 1000 gradient evaluations, and double that target after each warm-up window.</li>
<li>Instead of only using the posterior positions (Stan), we use the posterior POSITIONS AND GRADIENTS (like e.g.&nbsp;nutpie).</li>
<li>Instead of only using the MCMC/POSTERIOR positions and gradients (Stan and nutpie), we also store and use the INTERMEDIATE positions and gradients, i.e.&nbsp;the ones that MCMC visits before returning the “final” new position. We store up to (a default of) 1000 intermediate positions and gradients. The stored intermediate positions get selected (pseudo-)randomly, and only get selected if the Hamiltonian error is small enough.</li>
<li>Instead of only learning a single (linear) transformation and upating that one repeatedly, we learn several transformations in parallel and at the end of each warm-up window select the one that minimizes a loss function. Currently, we learn three different linear transformations:
<ul>
<li>Pathfinder’s initial transformation, enriched by an updated additional diagonal scaling</li>
<li>A standard diagonal “mass matrix”.</li>
<li>A novel, adaptive sequence of Householder transformations followed by diagonal scaling. The loss function that gets used to select the used linear transformation tries to reward transformations which turn the transformed posterior into something that’s close to a Normal distribution without correlation. For transformed positions p’ and gradients g’, the loss function is loss(p’, g’) = sum(log(std(p’) * std(g’))^2), which is zero for Normal distributions with zero correlations, independently of the samples positions and gradients.</li>
</ul></li>
<li>Instead of running the warm-up for a fixed number of windows, we try to estimate when continuing warming up is harmful/useless and stop warming up then. To facilitate this, we
<ul>
<li>only ever adapt the stepsize until (a default of) 50 MCMC transitions have ocurred in the current warm-up window,</li>
<li>and try to predict cost (in terms of gradient evaluations) for finishing sampling with the current kernel vs.&nbsp;restarting warm-up with a new window. The way we do this prediction will probably be changed in the future. By only ever having 50 stepsize adaptation MCMC transitions, we can start collecting posterio samples early.</li>
</ul></li>
</ul>
</section>
<section id="code-adaptive_warmup_mcmc.jl" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="code-adaptive_warmup_mcmc.jl">Code: <code>adaptive_warmup_mcmc.jl</code></h3>
<div class="column-page">
<p>The main code can be found at <a href="https://github.com/nsiccha/WarmupHMC.jl/blob/main/src/adaptive_warmup_mcmc.jl">https://github.com/nsiccha/WarmupHMC.jl/blob/main/src/adaptive_warmup_mcmc.jl</a>, also reproduced below:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1"></a><span class="st">"""</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="st">Adaptively learn </span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">* a (currently only) linear transformation of the posterior that simplifies MCMC sampling,</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">* a NUTS step size (using standard Dual Averaging)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="st">and return samples from the posterior. </span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="st">The warm-up procedure is windowed and somehow insipred by [Stan](https://mc-stan.org/docs/reference-manual/mcmc.html#automatic-parameter-tuning)'s and [nutpie](https://github.com/pymc-devs/nutpie)'s warm-up procedures, but differs in several important ways:</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="st">* We initialize using Pathfinder!</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="st">* Our warm-up windows aim to reach a certain number of GRADIENT EVALUATIONS , instead of a certain number of MCMC transitions (Stan).</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="st">We start with a (default) target of 1000 gradient evaluations, and double that target after each warm-up window.</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="st">* Instead of only using the posterior positions (Stan), we use the posterior POSITIONS AND GRADIENTS (like e.g. nutpie).</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="st">* Instead of only using the MCMC/POSTERIOR positions and gradients (Stan and nutpie), </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">we also store and use the INTERMEDIATE positions and gradients, i.e. the ones that MCMC visits before returning the "final" new position. </span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="st">We store up to (a default of) 1000 intermediate positions and gradients. </span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="st">The stored intermediate positions get selected (pseudo-)randomly, and only get selected if the Hamiltonian error is small enough.</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="st">* Instead of only learning a single (linear) transformation and upating that one repeatedly, we learn several transformations in parallel and</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="st">at the end of each warm-up window select the one that minimizes a loss function. Currently, we learn three different linear transformations:</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="st">    * Pathfinder's initial transformation, enriched by an updated additional diagonal scaling</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="st">    * A standard diagonal "mass matrix".</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="st">    * A novel, adaptive sequence of Householder transformations followed by diagonal scaling.</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="st">The loss function that gets used to select the used linear transformation tries to reward transformations which turn the transformed posterior</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="st">into something that's close to a Normal distribution without correlation. </span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="st">For transformed positions p' and gradients g', the loss function is </span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="st">    loss(p', g') = sum(log(std(p') * std(g'))^2), </span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="st">which is zero for Normal distributions with zero correlations, independently of the samples positions and gradients. </span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="st">* Instead of running the warm-up for a fixed number of windows, </span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="st">we try to estimate when continuing warming up is harmful/useless and stop warming up then. To facilitate this, we</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="st">    * only ever adapt the stepsize until (a default of) 50 MCMC transitions have ocurred in the current warm-up window,</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="st">    * and try to predict cost (in terms of gradient evaluations) for finishing sampling with the current kernel vs. restarting warm-up with a new window.</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="st">    The way we do this prediction will probably be changed in the future.</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="st">By only ever having 50 stepsize adaptation MCMC transitions, we can start collecting posterio samples early.</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="st">"""</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="fu">adaptive_warmup_mcmc</span>(</span>
<span id="cb1-36"><a href="#cb1-36"></a>    rng, lpdf; </span>
<span id="cb1-37"><a href="#cb1-37"></a>    <span class="co"># The number of posterior draws </span></span>
<span id="cb1-38"><a href="#cb1-38"></a>    n_draws<span class="op">=</span><span class="fl">1000</span>, </span>
<span id="cb1-39"><a href="#cb1-39"></a>    <span class="co"># The number of GRADIENT EVALUATIONS in the first window</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>    n_evaluations<span class="op">=</span><span class="fl">1000</span>, </span>
<span id="cb1-41"><a href="#cb1-41"></a>    <span class="co"># The upper limit of (intermediate) positions and gradients that will be recorded and then used for adaptation</span></span>
<span id="cb1-42"><a href="#cb1-42"></a>    recording_target<span class="op">=</span><span class="fl">1000</span>,</span>
<span id="cb1-43"><a href="#cb1-43"></a>    <span class="co"># The maximum number of transitions (per window) for which the stepsize gets adapted </span></span>
<span id="cb1-44"><a href="#cb1-44"></a>    stepsize_adaptation_limit<span class="op">=</span><span class="fl">50</span>, </span>
<span id="cb1-45"><a href="#cb1-45"></a>    target_acceptance_rate<span class="op">=</span><span class="fl">.8</span>, </span>
<span id="cb1-46"><a href="#cb1-46"></a>    max_tree_depth<span class="op">=</span><span class="fl">10</span>,</span>
<span id="cb1-47"><a href="#cb1-47"></a>    stepsize_search<span class="op">=</span>DynamicHMC.<span class="fu">InitialStepsizeSearch</span>(),</span>
<span id="cb1-48"><a href="#cb1-48"></a>    init<span class="op">=</span><span class="cn">missing</span>, </span>
<span id="cb1-49"><a href="#cb1-49"></a>    report<span class="op">=</span><span class="cn">true</span>, </span>
<span id="cb1-50"><a href="#cb1-50"></a>    monitor_ess<span class="op">=</span>report,</span>
<span id="cb1-51"><a href="#cb1-51"></a>    ) <span class="op">=</span> <span class="cf">begin</span> </span>
<span id="cb1-52"><a href="#cb1-52"></a>    <span class="co"># Standard Dual Averaging</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>    stepsize_adaptation <span class="op">=</span> DynamicHMC.<span class="fu">DualAveraging</span>(δ<span class="op">=</span>target_acceptance_rate)</span>
<span id="cb1-54"><a href="#cb1-54"></a>    <span class="co"># Standard NUTS</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>    algorithm <span class="op">=</span> DynamicHMC.<span class="fu">NUTS</span>(;max_depth<span class="op">=</span>max_tree_depth)</span>
<span id="cb1-56"><a href="#cb1-56"></a>    <span class="co"># The dimension of the posterior</span></span>
<span id="cb1-57"><a href="#cb1-57"></a>    dimension <span class="op">=</span> LogDensityProblems.<span class="fu">dimension</span>(lpdf)</span>
<span id="cb1-58"><a href="#cb1-58"></a>    <span class="co"># A thin wrapper around the posterior that enables us to record the intermediate positions and gradients</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>    recorder <span class="op">=</span> <span class="fu">LimitedRecorder2</span>(</span>
<span id="cb1-60"><a href="#cb1-60"></a>        <span class="co"># As above</span></span>
<span id="cb1-61"><a href="#cb1-61"></a>        recording_target,</span>
<span id="cb1-62"><a href="#cb1-62"></a>        <span class="co"># The initial "thinning" of intermediate positions and gradients </span></span>
<span id="cb1-63"><a href="#cb1-63"></a>        n_evaluations <span class="op">÷</span> recording_target, </span>
<span id="cb1-64"><a href="#cb1-64"></a>    )</span>
<span id="cb1-65"><a href="#cb1-65"></a>    recording_lpdf <span class="op">=</span> <span class="fu">RecordingPosterior2</span>(lpdf; recorder)</span>
<span id="cb1-66"><a href="#cb1-66"></a>    <span class="co"># Use Stan's initialization procedure if no initial position is given</span></span>
<span id="cb1-67"><a href="#cb1-67"></a>    <span class="fu">ismissing</span>(init) <span class="op">&amp;&amp;</span> (init <span class="op">=</span> <span class="fu">rand</span>(rng, <span class="fu">Uniform</span>(<span class="op">-</span><span class="fl">2</span>,<span class="op">+</span><span class="fl">2</span>), dimension))</span>
<span id="cb1-68"><a href="#cb1-68"></a>    <span class="co"># Run pathfinder once to get a linear transformation and a better initial position</span></span>
<span id="cb1-69"><a href="#cb1-69"></a>    pathfinder_result <span class="op">=</span> <span class="fu">pathfinder</span>(lpdf; rng, ndraws<span class="op">=</span><span class="fl">1</span>, init)</span>
<span id="cb1-70"><a href="#cb1-70"></a>    <span class="co"># The better initial position</span></span>
<span id="cb1-71"><a href="#cb1-71"></a>    position <span class="op">=</span> <span class="fu">collect</span>(pathfinder_result.draws[<span class="op">:</span>, <span class="fl">1</span>])<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb1-72"><a href="#cb1-72"></a>    <span class="co"># Pathfinder's linear transformation</span></span>
<span id="cb1-73"><a href="#cb1-73"></a>    pathfinder_transformation <span class="op">=</span> <span class="fu">factorize</span>(</span>
<span id="cb1-74"><a href="#cb1-74"></a>        pathfinder_result.fit_distribution.Σ).L<span class="op">::</span><span class="dt">Transpose{Float64, Pathfinder.WoodburyPDRightFactor{Float64, Diagonal{Float64, Vector{Float64}},</span></span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="dt">        LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}, UpperTriangular{Float64, Matrix{Float64}}}</span></span>
<span id="cb1-76"><a href="#cb1-76"></a><span class="dt">    }</span></span>
<span id="cb1-77"><a href="#cb1-77"></a>    <span class="co"># We currently learn three linear transformation options</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>    scale_options <span class="op">=</span> (</span>
<span id="cb1-79"><a href="#cb1-79"></a>        <span class="co"># Corresponds to a standard diagonal mass matrix</span></span>
<span id="cb1-80"><a href="#cb1-80"></a>        <span class="fu">Diagonal</span>(<span class="fu">sqrt</span>.(<span class="fu">diag</span>(pathfinder_result.fit_distribution.Σ))<span class="op">::</span><span class="dt">Vector{Float64}</span>),</span>
<span id="cb1-81"><a href="#cb1-81"></a>        <span class="co"># Corresponds to Pathfinder's linear transformation with an added diagonal scaling term that can be updated</span></span>
<span id="cb1-82"><a href="#cb1-82"></a>        <span class="fu">MatrixFactorization</span>(pathfinder_transformation, <span class="fu">Diagonal</span>(<span class="fu">ones</span>(dimension))),</span>
<span id="cb1-83"><a href="#cb1-83"></a>        <span class="co"># Something new. Corresponds to a sequence of Householder reflections, followed by a diagonal scaling term. </span></span>
<span id="cb1-84"><a href="#cb1-84"></a>        <span class="co"># Both the reflections and the diagonal scaling term will be updated. </span></span>
<span id="cb1-85"><a href="#cb1-85"></a>        <span class="fu">MatrixFactorization</span>(<span class="fu">SuccessiveReflections</span>(dimension), <span class="fu">Diagonal</span>(<span class="fu">ones</span>(dimension)))</span>
<span id="cb1-86"><a href="#cb1-86"></a>    )</span>
<span id="cb1-87"><a href="#cb1-87"></a>    <span class="co"># This is needed to make DynamicHMC "accept" our linear transformations</span></span>
<span id="cb1-88"><a href="#cb1-88"></a>    energy_options <span class="op">=</span> <span class="fu">map</span>(scale_options) <span class="cf">do</span> L</span>
<span id="cb1-89"><a href="#cb1-89"></a>        DynamicHMC.<span class="fu">GaussianKineticEnergy</span>(<span class="fu">MatrixFactorization</span>(L, L<span class="op">'</span>), <span class="fu">MatrixInverse</span>(L<span class="op">'</span>))</span>
<span id="cb1-90"><a href="#cb1-90"></a>    <span class="cf">end</span></span>
<span id="cb1-91"><a href="#cb1-91"></a>    <span class="co"># At the beginning, we will use Pathfinder's transformation.</span></span>
<span id="cb1-92"><a href="#cb1-92"></a>    <span class="co"># At later stages of warm-up, the estimated losses corresponding to each transformation will be written to `transformation_losses` </span></span>
<span id="cb1-93"><a href="#cb1-93"></a>    transformation_losses <span class="op">=</span> (<span class="fl">0</span>., <span class="fl">0</span>., <span class="fl">0</span>.)</span>
<span id="cb1-94"><a href="#cb1-94"></a>    active_option <span class="op">=</span> <span class="fl">2</span> <span class="co"># Pathfinder</span></span>
<span id="cb1-95"><a href="#cb1-95"></a>    kinetic_energy <span class="op">=</span> energy_options[active_option]</span>
<span id="cb1-96"><a href="#cb1-96"></a>    <span class="co"># The below tries to find a good initial stepsize. </span></span>
<span id="cb1-97"><a href="#cb1-97"></a>    position_and_gradient <span class="op">=</span> DynamicHMC.<span class="fu">evaluate_ℓ</span>(lpdf, position; strict<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb1-98"><a href="#cb1-98"></a>    position_gradient_and_momentum <span class="op">=</span> DynamicHMC.<span class="fu">PhasePoint</span>(position_and_gradient, DynamicHMC.<span class="fu">rand_p</span>(rng, kinetic_energy))</span>
<span id="cb1-99"><a href="#cb1-99"></a>    stepsize <span class="op">=</span> DynamicHMC.<span class="fu">find_initial_stepsize</span>(</span>
<span id="cb1-100"><a href="#cb1-100"></a>        stepsize_search, </span>
<span id="cb1-101"><a href="#cb1-101"></a>        DynamicHMC.<span class="fu">local_log_acceptance_ratio</span>(</span>
<span id="cb1-102"><a href="#cb1-102"></a>            DynamicHMC.<span class="fu">Hamiltonian</span>(kinetic_energy, lpdf), position_gradient_and_momentum</span>
<span id="cb1-103"><a href="#cb1-103"></a>        )</span>
<span id="cb1-104"><a href="#cb1-104"></a>    )</span>
<span id="cb1-105"><a href="#cb1-105"></a>    <span class="co"># The below variables give us access to the matrices into which the intermediate positions and gradients and the MCMC positions an gradients will be written</span></span>
<span id="cb1-106"><a href="#cb1-106"></a>    (;</span>
<span id="cb1-107"><a href="#cb1-107"></a>        <span class="co"># Intermediate positions</span></span>
<span id="cb1-108"><a href="#cb1-108"></a>        halo_position, </span>
<span id="cb1-109"><a href="#cb1-109"></a>        <span class="co"># Intermediate gradients</span></span>
<span id="cb1-110"><a href="#cb1-110"></a>        halo_gradient, </span>
<span id="cb1-111"><a href="#cb1-111"></a>        <span class="co"># MCMC positions</span></span>
<span id="cb1-112"><a href="#cb1-112"></a>        posterior_position,</span>
<span id="cb1-113"><a href="#cb1-113"></a>        <span class="co"># MCMC gradients</span></span>
<span id="cb1-114"><a href="#cb1-114"></a>        posterior_gradient</span>
<span id="cb1-115"><a href="#cb1-115"></a>    ) <span class="op">=</span> recording_lpdf</span>
<span id="cb1-116"><a href="#cb1-116"></a>    <span class="co"># This will try to predict the future number of steps needed, if we adopt the new linear transformation.</span></span>
<span id="cb1-117"><a href="#cb1-117"></a>    <span class="co"># It's currently doing something slightly silly, and I will change what exactly it does. </span></span>
<span id="cb1-118"><a href="#cb1-118"></a>    depth_predictor <span class="op">=</span> <span class="fu">DepthPredictor</span>(max_tree_depth)</span>
<span id="cb1-119"><a href="#cb1-119"></a>    <span class="co"># For monitoring purposes: Keep track of the number of gradient evaluations during warm-up</span></span>
<span id="cb1-120"><a href="#cb1-120"></a>    total_evaluation_counter <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-121"><a href="#cb1-121"></a>    <span class="co"># For monitoring purposes: Keep track of the number of warm-up windows so far</span></span>
<span id="cb1-122"><a href="#cb1-122"></a>    outer_counter <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-123"><a href="#cb1-123"></a>    <span class="co"># For monitoring purposes: Keep track of the number of the total number of MCMC transitions</span></span>
<span id="cb1-124"><a href="#cb1-124"></a>    total_transition_counter <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-125"><a href="#cb1-125"></a>    <span class="co"># For monitoring purposes: Displays the progress and additional info</span></span>
<span id="cb1-126"><a href="#cb1-126"></a>    progress <span class="op">=</span> report ? ProgressMeter.<span class="fu">Progress</span>(n_draws; dt<span class="op">=</span><span class="fl">1e-3</span>, desc<span class="op">=</span><span class="st">"Sampling..."</span>) <span class="op">:</span> <span class="cn">nothing</span></span>
<span id="cb1-127"><a href="#cb1-127"></a>    <span class="co"># For monitoring purposes: Keep track of the minimal effective sample size so far</span></span>
<span id="cb1-128"><a href="#cb1-128"></a>    min_ess <span class="op">=</span> <span class="cn">missing</span></span>
<span id="cb1-129"><a href="#cb1-129"></a>    <span class="co"># For monitoring purposes: Keep track of the current number of gradient evaluations per MCMC transition</span></span>
<span id="cb1-130"><a href="#cb1-130"></a>    steps_per_draw <span class="op">=</span> <span class="cn">missing</span></span>
<span id="cb1-131"><a href="#cb1-131"></a>    <span class="co"># For monitoring purposes: Keep track of the number of divergences in the current WARM-UP window</span></span>
<span id="cb1-132"><a href="#cb1-132"></a>    n_divergent <span class="op">=</span> <span class="cn">missing</span></span>
<span id="cb1-133"><a href="#cb1-133"></a>    <span class="co"># For monitoring purposes: Keep track of the number of divergences in the current SAMPLING window</span></span>
<span id="cb1-134"><a href="#cb1-134"></a>    n_divergent_samples <span class="op">=</span> <span class="cn">missing</span></span>
<span id="cb1-135"><a href="#cb1-135"></a>    <span class="co"># We run the warm-up procedure until we have collected enough samples</span></span>
<span id="cb1-136"><a href="#cb1-136"></a>    <span class="cf">while</span> <span class="fu">size</span>(posterior_position, <span class="fl">2</span>) <span class="op">&lt;</span> n_draws</span>
<span id="cb1-137"><a href="#cb1-137"></a>        <span class="co"># Some setup that has to happen at the beginning of every warm-up window</span></span>
<span id="cb1-138"><a href="#cb1-138"></a>        outer_counter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-139"><a href="#cb1-139"></a>        hamiltonian <span class="op">=</span> DynamicHMC.<span class="fu">Hamiltonian</span>(kinetic_energy, recording_lpdf)</span>
<span id="cb1-140"><a href="#cb1-140"></a>        stepsize_state <span class="op">=</span> DynamicHMC.<span class="fu">initial_adaptation_state</span>(stepsize_adaptation, stepsize)</span>
<span id="cb1-141"><a href="#cb1-141"></a>        stepsize <span class="op">=</span> DynamicHMC.<span class="fu">current_ϵ</span>(stepsize_state)</span>
<span id="cb1-142"><a href="#cb1-142"></a>        <span class="co"># Reset the so far recorded intermediate and MCMC positions and gradients</span></span>
<span id="cb1-143"><a href="#cb1-143"></a>        <span class="fu">reset!</span>(recording_lpdf)</span>
<span id="cb1-144"><a href="#cb1-144"></a>        current_transition_counter <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-145"><a href="#cb1-145"></a>        steps_per_draw <span class="op">=</span> <span class="fu">current_steps</span>(depth_predictor)</span>
<span id="cb1-146"><a href="#cb1-146"></a>        finish_cost <span class="op">=</span> restart_cost <span class="op">=</span> (n_draws <span class="op">+</span> stepsize_adaptation_limit) <span class="op">*</span> steps_per_draw</span>
<span id="cb1-147"><a href="#cb1-147"></a>        n_divergent <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-148"><a href="#cb1-148"></a>        n_divergent_samples <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-149"><a href="#cb1-149"></a>        current_evaluation_counter <span class="op">=</span> <span class="fl">0</span></span>
<span id="cb1-150"><a href="#cb1-150"></a>        <span class="co"># We run the current warm-up/sampling window until </span></span>
<span id="cb1-151"><a href="#cb1-151"></a>        <span class="co">#   a) we have collected enough samples and can break out of the outer loop as well or</span></span>
<span id="cb1-152"><a href="#cb1-152"></a>        <span class="co">#   b) we have reached the current targeted number of gradient evaluations AND we estimate that </span></span>
<span id="cb1-153"><a href="#cb1-153"></a>        <span class="co">#       restarting (adding a new warm-up window) is better than finishing sampling with the current adaptation</span></span>
<span id="cb1-154"><a href="#cb1-154"></a>        <span class="cf">while</span> <span class="fu">size</span>(posterior_position, <span class="fl">2</span>) <span class="op">&lt;</span> n_draws <span class="op">&amp;&amp;</span> (</span>
<span id="cb1-155"><a href="#cb1-155"></a>            current_evaluation_counter <span class="op">&lt;</span> n_evaluations <span class="op">||</span> finish_cost <span class="op">&lt;</span> restart_cost </span>
<span id="cb1-156"><a href="#cb1-156"></a>        )</span>
<span id="cb1-157"><a href="#cb1-157"></a>            current_transition_counter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-158"><a href="#cb1-158"></a>            total_transition_counter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb1-159"><a href="#cb1-159"></a>            <span class="co"># One MCMC transition</span></span>
<span id="cb1-160"><a href="#cb1-160"></a>            position_and_gradient, stats <span class="op">=</span> DynamicHMC.<span class="fu">sample_tree</span>(rng, algorithm, hamiltonian, position_and_gradient, stepsize)</span>
<span id="cb1-161"><a href="#cb1-161"></a>            total_evaluation_counter <span class="op">+=</span> stats.steps</span>
<span id="cb1-162"><a href="#cb1-162"></a>            current_evaluation_counter <span class="op">+=</span> stats.steps</span>
<span id="cb1-163"><a href="#cb1-163"></a>            <span class="co"># Add information about the current transition to our predictor</span></span>
<span id="cb1-164"><a href="#cb1-164"></a>            <span class="fu">record!</span>(depth_predictor, stats)</span>
<span id="cb1-165"><a href="#cb1-165"></a>            is_divergent <span class="op">=</span> DynamicHMC.<span class="fu">is_divergent</span>(stats.termination)</span>
<span id="cb1-166"><a href="#cb1-166"></a>            is_divergent <span class="op">&amp;&amp;</span> (n_divergent <span class="op">+=</span> <span class="fl">1</span>)</span>
<span id="cb1-167"><a href="#cb1-167"></a>            <span class="cf">if</span> current_transition_counter <span class="op">&lt;</span> stepsize_adaptation_limit</span>
<span id="cb1-168"><a href="#cb1-168"></a>                <span class="co"># The current warm-up window has seen fewer MCMC transitions than our step size adaptation limit.</span></span>
<span id="cb1-169"><a href="#cb1-169"></a>                <span class="co"># Continue adapting the step size.</span></span>
<span id="cb1-170"><a href="#cb1-170"></a>                stepsize_state <span class="op">=</span> DynamicHMC.<span class="fu">adapt_stepsize</span>(stepsize_adaptation, stepsize_state, stats.acceptance_rate)</span>
<span id="cb1-171"><a href="#cb1-171"></a>                stepsize <span class="op">=</span> DynamicHMC.<span class="fu">current_ϵ</span>(stepsize_state)</span>
<span id="cb1-172"><a href="#cb1-172"></a>            <span class="cf">elseif</span> current_transition_counter <span class="op">==</span> stepsize_adaptation_limit</span>
<span id="cb1-173"><a href="#cb1-173"></a>                <span class="co"># The current warm-up window hits the step size adaptation limit.</span></span>
<span id="cb1-174"><a href="#cb1-174"></a>                <span class="co"># Finalize the stepsize.</span></span>
<span id="cb1-175"><a href="#cb1-175"></a>                stepsize <span class="op">=</span> DynamicHMC.<span class="fu">final_ϵ</span>(stepsize_state)</span>
<span id="cb1-176"><a href="#cb1-176"></a>            <span class="cf">else</span></span>
<span id="cb1-177"><a href="#cb1-177"></a>                <span class="co"># The current warm-up window has been sampling with the same linear transformation and step size.</span></span>
<span id="cb1-178"><a href="#cb1-178"></a>                <span class="co"># Record posterior positions, gradients and whether the current transition diverged</span></span>
<span id="cb1-179"><a href="#cb1-179"></a>                <span class="fu">append!</span>(posterior_position, position_and_gradient.q)</span>
<span id="cb1-180"><a href="#cb1-180"></a>                <span class="fu">append!</span>(posterior_gradient, position_and_gradient.∇ℓq)</span>
<span id="cb1-181"><a href="#cb1-181"></a>                is_divergent <span class="op">&amp;&amp;</span> (n_divergent_samples <span class="op">+=</span> <span class="fl">1</span>)</span>
<span id="cb1-182"><a href="#cb1-182"></a>            <span class="cf">end</span></span>
<span id="cb1-183"><a href="#cb1-183"></a>            <span class="co"># Update the current steps per draw and predicted steps per draw should we add a new warm-up window,</span></span>
<span id="cb1-184"><a href="#cb1-184"></a>            <span class="co"># as well as the estimated cost for finishing sampling with the current kernel or restarting warm-up. </span></span>
<span id="cb1-185"><a href="#cb1-185"></a>            <span class="co"># I think this actually only has to happen once, will change at some point in the future.</span></span>
<span id="cb1-186"><a href="#cb1-186"></a>            steps_per_draw <span class="op">=</span> <span class="fu">current_steps</span>(depth_predictor)</span>
<span id="cb1-187"><a href="#cb1-187"></a>            potential_steps_per_draw <span class="op">=</span> <span class="fu">potential_steps</span>(depth_predictor)</span>
<span id="cb1-188"><a href="#cb1-188"></a>            finish_cost <span class="op">=</span> (n_draws <span class="op">+</span> stepsize_adaptation_limit <span class="op">-</span> current_transition_counter) <span class="op">*</span> steps_per_draw</span>
<span id="cb1-189"><a href="#cb1-189"></a>            restart_cost <span class="op">=</span> (n_draws <span class="op">+</span> stepsize_adaptation_limit) <span class="op">*</span> potential_steps_per_draw</span>
<span id="cb1-190"><a href="#cb1-190"></a>            report <span class="op">&amp;&amp;</span> ProgressMeter.<span class="fu">update!</span>(progress, <span class="fu">size</span>(posterior_position, <span class="fl">2</span>), showvalues<span class="op">=</span><span class="fu">pairs</span>(</span>
<span id="cb1-191"><a href="#cb1-191"></a>                <span class="fu">merge</span>(</span>
<span id="cb1-192"><a href="#cb1-192"></a>                    <span class="fu">round2</span>((;outer_counter, current_transition_counter, total_transition_counter, transformation_losses, finish_cost, restart_cost, total_evaluation_counter, steps_per_draw, potential_steps_per_draw, stepsize, n_divergent, n_divergent_samples, min_ess, recorder<span class="op">=</span>(;recorder.target, recorder.thin, recorder.outer_count, recorder.inner_count, recorder.triggered, recorded<span class="op">=</span><span class="fu">size</span>(halo_position, <span class="fl">2</span>)))),</span>
<span id="cb1-193"><a href="#cb1-193"></a>                )</span>
<span id="cb1-194"><a href="#cb1-194"></a>            ))</span>
<span id="cb1-195"><a href="#cb1-195"></a>        <span class="cf">end</span></span>
<span id="cb1-196"><a href="#cb1-196"></a>        <span class="fu">advance!</span>(depth_predictor)</span>
<span id="cb1-197"><a href="#cb1-197"></a>        <span class="co"># Double the targeted number of GRADIENT EVALUATIONS in the next warm-up window</span></span>
<span id="cb1-198"><a href="#cb1-198"></a>        n_evaluations <span class="op">*=</span> <span class="fl">2</span></span>
<span id="cb1-199"><a href="#cb1-199"></a>        <span class="co"># Recompute the thinning factor for the intermediate positions and gradients</span></span>
<span id="cb1-200"><a href="#cb1-200"></a>        recorder.thin <span class="op">=</span> n_evaluations <span class="op">÷</span> recording_target</span>
<span id="cb1-201"><a href="#cb1-201"></a>        <span class="co"># Update the linear transformation candidates and estimate the transformation loss,</span></span>
<span id="cb1-202"><a href="#cb1-202"></a>        <span class="co"># using the INTERMEDIATE POSITIONS AND GRADIENTS.</span></span>
<span id="cb1-203"><a href="#cb1-203"></a>        <span class="co"># AT THIS POINT WE CAN ALSO LEARN NON-LINEAR TRANSFORMATIONS, </span></span>
<span id="cb1-204"><a href="#cb1-204"></a>        <span class="co"># AND AGAIN SELECT THE ONE THAT MINIMIZES THE TRANSFORMATION LOSS.</span></span>
<span id="cb1-205"><a href="#cb1-205"></a>        transformation_losses <span class="op">=</span> <span class="fu">map</span>(<span class="fu">L-&gt;update_loss!</span>(L, (halo_position), (halo_gradient)), scale_options)</span>
<span id="cb1-206"><a href="#cb1-206"></a>        <span class="co"># Update the new linear transformation to be the one with the minimal estimated transformation loss.</span></span>
<span id="cb1-207"><a href="#cb1-207"></a>        active_option <span class="op">=</span> <span class="fu">argmin</span>(transformation_losses)</span>
<span id="cb1-208"><a href="#cb1-208"></a>        kinetic_energy <span class="op">=</span> energy_options[active_option]</span>
<span id="cb1-209"><a href="#cb1-209"></a>        (monitor_ess <span class="op">&amp;&amp;</span> <span class="fu">size</span>(posterior_position, <span class="fl">2</span>) <span class="op">&gt;</span> <span class="fl">10</span>) <span class="op">&amp;&amp;</span> (min_ess <span class="op">=</span> <span class="fu">minimum</span>(</span>
<span id="cb1-210"><a href="#cb1-210"></a>            MCMCDiagnosticTools.<span class="fu">ess</span>(<span class="fu">reshape</span>(posterior_position<span class="op">'</span>, (<span class="op">:</span>, <span class="fl">1</span>, dimension)))</span>
<span id="cb1-211"><a href="#cb1-211"></a>        ))</span>
<span id="cb1-212"><a href="#cb1-212"></a>    <span class="cf">end</span></span>
<span id="cb1-213"><a href="#cb1-213"></a>    report <span class="op">&amp;&amp;</span> ProgressMeter.<span class="fu">update!</span>(progress, <span class="fu">size</span>(posterior_position, <span class="fl">2</span>), showvalues<span class="op">=</span><span class="fu">pairs</span>(</span>
<span id="cb1-214"><a href="#cb1-214"></a>        <span class="fu">merge</span>(</span>
<span id="cb1-215"><a href="#cb1-215"></a>            <span class="fu">round2</span>((;outer_counter, total_transition_counter, transformation_losses, total_evaluation_counter, steps_per_draw, stepsize, n_divergent_samples, min_ess)),</span>
<span id="cb1-216"><a href="#cb1-216"></a>        )</span>
<span id="cb1-217"><a href="#cb1-217"></a>    ))</span>
<span id="cb1-218"><a href="#cb1-218"></a>    recording_lpdf</span>
<span id="cb1-219"><a href="#cb1-219"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sampling-efficiency-comparison-linear-transformations" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sampling-efficiency-comparison-linear-transformations">Sampling efficiency comparison: linear transformations</h2>
<p>The below table compares the adaptive warmup procedure with the “regular” linear warm-up procedure as used e.g.&nbsp;by Stan, as implemented in <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a>. All benchmarks are run on my local machine using <a href="https://roualdes.github.io/bridgestan/latest/">BridgeStan.jl</a> and <a href="https://github.com/sethaxen/PosteriorDB.jl">PosteriorDB.jl</a>. <strong>This table only includes learning linear transformations.</strong></p>
<p>Meaning of columns:</p>
<ul>
<li><strong>Posterior</strong>: The name of the posterior in <a href="https://github.com/stan-dev/posteriordb">posteriordb</a>.</li>
<li><strong>dimension</strong>: The dimension of the posterior.</li>
<li><strong>#runs</strong>: The number of individual chains run to compute the benchmark statistics (the next columns).</li>
<li><strong>Adaptive advantage</strong>: The ratio of the mean sampling efficiency of the adaptive warm-up and the mean sampling efficiency of the regular warm-up. The chainwise sampling efficiency has been computed my dividing the minimum (over the parameters) effective sample size by the total number of gradient evaluations in that chain’s run.</li>
<li><strong>Adaptive/Regular: min. ess</strong>: The mean minimum effective sample size (for the mean) for the adaptive or regular warm-up respectively.</li>
<li><strong>Adaptive/Regular: #gradient evals</strong>: The mean total number of gradient evaluations.</li>
</ul>
<p>Posteriors where the regular warm-up takes too long have been skipped so far due to time-reasons. The table is sorted first by <code>#runs</code> (descending) and then by <code>Adaptive advantage</code> (ascending).</p>
<div class="column-page">
<div id="5c948a69" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<table class="interactive caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header headerLastRow">
<th style="text-align: right;" data-quarto-table-cell-role="th">Posterior</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">dimension</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">#runs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adaptive advantage</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adaptive: min. ess</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Regular: min. ess</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Adaptive: #gradient evals</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Regular: #gradient evals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">mcycle_splines-accel_splines</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: red; font-weight: bold;">0.091</td>
<td style="text-align: right;">4.7</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">780k</td>
<td style="text-align: right;">1.8M</td>
</tr>
<tr class="even">
<td style="text-align: right;">mcycle_gp-accel_gp</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: red; font-weight: bold;">0.18</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">890k</td>
<td style="text-align: right;">1.4M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_variable_slope_centered</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: red; font-weight: bold;">0.2</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">57k</td>
<td style="text-align: right;">46k</td>
</tr>
<tr class="even">
<td style="text-align: right;">rats_data-rats_model</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: red; font-weight: bold;">0.5</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">330k</td>
<td style="text-align: right;">73k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GLMM_Poisson_data-GLMM_Poisson_model</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: red; font-weight: bold;">0.7</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">39k</td>
<td style="text-align: right;">120k</td>
</tr>
<tr class="even">
<td style="text-align: right;">Survey_data-Survey_model</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.1</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">6.9k</td>
<td style="text-align: right;">9.2k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">eight_schools-eight_schools_centered</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.2</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">37k</td>
<td style="text-align: right;">52k</td>
</tr>
<tr class="even">
<td style="text-align: right;">Rate_4_data-Rate_4_model</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.3</td>
<td style="text-align: right;">520</td>
<td style="text-align: right;">620</td>
<td style="text-align: right;">5.5k</td>
<td style="text-align: right;">8.3k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">gp_pois_regr-gp_regr</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.4</td>
<td style="text-align: right;">900</td>
<td style="text-align: right;">930</td>
<td style="text-align: right;">6.2k</td>
<td style="text-align: right;">8.9k</td>
</tr>
<tr class="even">
<td style="text-align: right;">Rate_3_data-Rate_3_model</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.4</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">340</td>
<td style="text-align: right;">3.4k</td>
<td style="text-align: right;">4.7k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Rate_1_data-Rate_1_model</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.4</td>
<td style="text-align: right;">370</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">3.2k</td>
<td style="text-align: right;">5k</td>
</tr>
<tr class="even">
<td style="text-align: right;">normal_2-normal_mixture</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.4</td>
<td style="text-align: right;">920</td>
<td style="text-align: right;">930</td>
<td style="text-align: right;">5.8k</td>
<td style="text-align: right;">8.3k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_partially_pooled_centered</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.5</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">17k</td>
<td style="text-align: right;">31k</td>
</tr>
<tr class="even">
<td style="text-align: right;">Mtbh_data-Mtbh_model</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.5</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">18k</td>
<td style="text-align: right;">31k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Rate_2_data-Rate_2_model</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.5</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">730</td>
<td style="text-align: right;">4.9k</td>
<td style="text-align: right;">7.1k</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_mn-radon_variable_intercept_centered</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.6</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">17k</td>
<td style="text-align: right;">31k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">seeds_data-seeds_centered_model</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.7</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">16k</td>
<td style="text-align: right;">37k</td>
</tr>
<tr class="even">
<td style="text-align: right;">soil_carbon-soil_incubation</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.7</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">230k</td>
<td style="text-align: right;">160k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">surgical_data-surgical_model</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.8</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">13k</td>
<td style="text-align: right;">22k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_dae_inter_model</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.8</td>
<td style="text-align: right;">1.3k</td>
<td style="text-align: right;">1.2k</td>
<td style="text-align: right;">7.3k</td>
<td style="text-align: right;">12k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_variable_intercept_slope_noncentered</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.8</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">220</td>
<td style="text-align: right;">20k</td>
<td style="text-align: right;">84k</td>
</tr>
<tr class="even">
<td style="text-align: right;">gp_pois_regr-gp_pois_regr</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.8</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">75k</td>
<td style="text-align: right;">330k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">arma-arma11</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.8</td>
<td style="text-align: right;">880</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">6.9k</td>
<td style="text-align: right;">12k</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_mn-radon_hierarchical_intercept_centered</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.9</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">17k</td>
<td style="text-align: right;">40k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Rate_5_data-Rate_5_model</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.9</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">2.8k</td>
<td style="text-align: right;">4.8k</td>
</tr>
<tr class="even">
<td style="text-align: right;">normal_5-normal_mixture_k</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">94k</td>
<td style="text-align: right;">180k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">bones_data-bones_model</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.9</td>
<td style="text-align: right;">1.8k</td>
<td style="text-align: right;">1.6k</td>
<td style="text-align: right;">8.3k</td>
<td style="text-align: right;">14k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_interaction_c_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2</td>
<td style="text-align: right;">950</td>
<td style="text-align: right;">780</td>
<td style="text-align: right;">6.6k</td>
<td style="text-align: right;">11k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Mb_data-Mb_model</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2</td>
<td style="text-align: right;">630</td>
<td style="text-align: right;">560</td>
<td style="text-align: right;">5.9k</td>
<td style="text-align: right;">11k</td>
</tr>
<tr class="even">
<td style="text-align: right;">uk_drivers-state_space_stochastic_level_stochastic_seasonal</td>
<td style="text-align: right;">389</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">770k</td>
<td style="text-align: right;">1.3M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">pilots-pilots</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2</td>
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">170k</td>
<td style="text-align: right;">360k</td>
</tr>
<tr class="even">
<td style="text-align: right;">irt_2pl-irt_2pl</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">22k</td>
<td style="text-align: right;">50k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GLMM_data-GLMM1_model</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.1</td>
<td style="text-align: right;">1.6k</td>
<td style="text-align: right;">1.3k</td>
<td style="text-align: right;">19k</td>
<td style="text-align: right;">32k</td>
</tr>
<tr class="even">
<td style="text-align: right;">dogs-dogs_nonhierarchical</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.2</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">19k</td>
<td style="text-align: right;">42k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_variable_intercept_slope_centered</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.2</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">20k</td>
<td style="text-align: right;">74k</td>
</tr>
<tr class="even">
<td style="text-align: right;">eight_schools-eight_schools_noncentered</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.2</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">530</td>
<td style="text-align: right;">8.4k</td>
<td style="text-align: right;">20k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">one_comp_mm_elim_abs-one_comp_mm_elim_abs</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.3</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">9.5k</td>
<td style="text-align: right;">19k</td>
</tr>
<tr class="even">
<td style="text-align: right;">Mt_data-Mt_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.3</td>
<td style="text-align: right;">910</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">6.5k</td>
<td style="text-align: right;">9.8k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">M0_data-M0_model</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.4</td>
<td style="text-align: right;">850</td>
<td style="text-align: right;">540</td>
<td style="text-align: right;">5k</td>
<td style="text-align: right;">7.7k</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_pooled</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.4</td>
<td style="text-align: right;">910</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">5.8k</td>
<td style="text-align: right;">9.1k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_pooled</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.4</td>
<td style="text-align: right;">980</td>
<td style="text-align: right;">690</td>
<td style="text-align: right;">5.6k</td>
<td style="text-align: right;">9.6k</td>
</tr>
<tr class="even">
<td style="text-align: right;">seeds_data-seeds_model</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.5</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">15k</td>
<td style="text-align: right;">40k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">low_dim_gauss_mix-low_dim_gauss_mix</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.5</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">880</td>
<td style="text-align: right;">7.1k</td>
<td style="text-align: right;">14k</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_mn-radon_county_intercept</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.7</td>
<td style="text-align: right;">960</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">13k</td>
<td style="text-align: right;">35k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">butterfly-multi_occupancy</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.7</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">37k</td>
<td style="text-align: right;">110k</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_mn-radon_partially_pooled_noncentered</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.8</td>
<td style="text-align: right;">270</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">15k</td>
<td style="text-align: right;">60k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">garch-garch11</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.8</td>
<td style="text-align: right;">470</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">8.4k</td>
<td style="text-align: right;">21k</td>
</tr>
<tr class="even">
<td style="text-align: right;">dogs-dogs_hierarchical</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.9</td>
<td style="text-align: right;">710</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">5.3k</td>
<td style="text-align: right;">8.7k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mesquite-logmesquite_logvolume</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.2</td>
<td style="text-align: right;">820</td>
<td style="text-align: right;">490</td>
<td style="text-align: right;">6.2k</td>
<td style="text-align: right;">12k</td>
</tr>
<tr class="even">
<td style="text-align: right;">seeds_data-seeds_stanified_model</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.2</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">16k</td>
<td style="text-align: right;">35k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kidiq_with_mom_work-kidscore_interaction_c</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.4</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">780</td>
<td style="text-align: right;">7k</td>
<td style="text-align: right;">18k</td>
</tr>
<tr class="even">
<td style="text-align: right;">GLM_Binomial_data-GLM_Binomial_model</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.5</td>
<td style="text-align: right;">920</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">5.8k</td>
<td style="text-align: right;">13k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">three_docs1200-ldaK2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.5</td>
<td style="text-align: right;">620</td>
<td style="text-align: right;">470</td>
<td style="text-align: right;">9.4k</td>
<td style="text-align: right;">25k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_dae_c_model</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.5</td>
<td style="text-align: right;">860</td>
<td style="text-align: right;">640</td>
<td style="text-align: right;">6.5k</td>
<td style="text-align: right;">17k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_variable_intercept_noncentered</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.6</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">19k</td>
<td style="text-align: right;">60k</td>
</tr>
<tr class="even">
<td style="text-align: right;">dogs-dogs_log</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">3.7</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">280</td>
<td style="text-align: right;">6.3k</td>
<td style="text-align: right;">11k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">sesame_data-sesame_one_pred_a</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">4.6</td>
<td style="text-align: right;">860</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">6.1k</td>
<td style="text-align: right;">15k</td>
</tr>
<tr class="even">
<td style="text-align: right;">rstan_downloads-prophet</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">4.6</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">520</td>
<td style="text-align: right;">210k</td>
<td style="text-align: right;">1.6M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_hierarchical_intercept_noncentered</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">4.6</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">19k</td>
<td style="text-align: right;">79k</td>
</tr>
<tr class="even">
<td style="text-align: right;">loss_curves-losscurve_sislob</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">4.8</td>
<td style="text-align: right;">840</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">9k</td>
<td style="text-align: right;">23k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_mn-radon_variable_slope_noncentered</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">5.2</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">16k</td>
<td style="text-align: right;">75k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_daae_c_model</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">5.5</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">7k</td>
<td style="text-align: right;">20k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kidiq_with_mom_work-kidscore_interaction_c2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">6</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">510</td>
<td style="text-align: right;">7k</td>
<td style="text-align: right;">20k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_dae_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">6</td>
<td style="text-align: right;">940</td>
<td style="text-align: right;">570</td>
<td style="text-align: right;">6.7k</td>
<td style="text-align: right;">25k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">wells_data-wells_dist100ars_model</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">6.7</td>
<td style="text-align: right;">890</td>
<td style="text-align: right;">460</td>
<td style="text-align: right;">5.6k</td>
<td style="text-align: right;">19k</td>
</tr>
<tr class="even">
<td style="text-align: right;">dugongs_data-dugongs_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">6.7</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">7.2k</td>
<td style="text-align: right;">39k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">wells_data-wells_dist100_model</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">6.8</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">5k</td>
<td style="text-align: right;">11k</td>
</tr>
<tr class="even">
<td style="text-align: right;">earnings-logearn_interaction_z</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">7.1</td>
<td style="text-align: right;">1k</td>
<td style="text-align: right;">490</td>
<td style="text-align: right;">6.6k</td>
<td style="text-align: right;">22k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">dogs-dogs</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">7.5</td>
<td style="text-align: right;">900</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">6.1k</td>
<td style="text-align: right;">21k</td>
</tr>
<tr class="even">
<td style="text-align: right;">GLM_Poisson_Data-GLM_Poisson_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">12</td>
<td style="text-align: right;">980</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">3.2k</td>
<td style="text-align: right;">28k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">sblri-blr</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">14</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">7.5k</td>
<td style="text-align: right;">19k</td>
</tr>
<tr class="even">
<td style="text-align: right;">nes1992-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">15</td>
<td style="text-align: right;">820</td>
<td style="text-align: right;">440</td>
<td style="text-align: right;">10k</td>
<td style="text-align: right;">80k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mesquite-logmesquite</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">16</td>
<td style="text-align: right;">870</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">8.4k</td>
<td style="text-align: right;">54k</td>
</tr>
<tr class="even">
<td style="text-align: right;">arK-arK</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">18</td>
<td style="text-align: right;">1.3k</td>
<td style="text-align: right;">560</td>
<td style="text-align: right;">8k</td>
<td style="text-align: right;">59k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">nes1976-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">19</td>
<td style="text-align: right;">860</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">8.9k</td>
<td style="text-align: right;">85k</td>
</tr>
<tr class="even">
<td style="text-align: right;">nes_logit_data-nes_logit_model</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">19</td>
<td style="text-align: right;">950</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">4.8k</td>
<td style="text-align: right;">18k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mesquite-logmesquite_logva</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">20</td>
<td style="text-align: right;">950</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">7.3k</td>
<td style="text-align: right;">56k</td>
</tr>
<tr class="even">
<td style="text-align: right;">hudson_lynx_hare-lotka_volterra</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">21</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">7.2k</td>
<td style="text-align: right;">67k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">wells_data-wells_interaction_model</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">22</td>
<td style="text-align: right;">950</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">6.9k</td>
<td style="text-align: right;">33k</td>
</tr>
<tr class="even">
<td style="text-align: right;">nes2000-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">23</td>
<td style="text-align: right;">760</td>
<td style="text-align: right;">340</td>
<td style="text-align: right;">9k</td>
<td style="text-align: right;">92k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">nes1972-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">24</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">8.7k</td>
<td style="text-align: right;">79k</td>
</tr>
<tr class="even">
<td style="text-align: right;">nes1988-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">24</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">440</td>
<td style="text-align: right;">8.7k</td>
<td style="text-align: right;">82k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kidiq_with_mom_work-kidscore_interaction_z</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">24</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">6.9k</td>
<td style="text-align: right;">63k</td>
</tr>
<tr class="even">
<td style="text-align: right;">nes1984-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">25</td>
<td style="text-align: right;">1.2k</td>
<td style="text-align: right;">480</td>
<td style="text-align: right;">8.5k</td>
<td style="text-align: right;">83k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kidiq-kidscore_momiq</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">25</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">6.1k</td>
<td style="text-align: right;">66k</td>
</tr>
<tr class="even">
<td style="text-align: right;">sblrc-blr</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">26</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">7.8k</td>
<td style="text-align: right;">32k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">nes1996-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">26</td>
<td style="text-align: right;">1k</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">8.4k</td>
<td style="text-align: right;">91k</td>
</tr>
<tr class="even">
<td style="text-align: right;">wells_data-wells_dist</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">30</td>
<td style="text-align: right;">920</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">5k</td>
<td style="text-align: right;">31k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mesquite-logmesquite_logvas</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">34</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">8k</td>
<td style="text-align: right;">93k</td>
</tr>
<tr class="even">
<td style="text-align: right;">kidiq-kidscore_momhs</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">37</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">5.3k</td>
<td style="text-align: right;">36k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mesquite-logmesquite_logvash</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">38</td>
<td style="text-align: right;">880</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">7.9k</td>
<td style="text-align: right;">87k</td>
</tr>
<tr class="even">
<td style="text-align: right;">kidiq_with_mom_work-kidscore_mom_work</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">39</td>
<td style="text-align: right;">930</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">7.4k</td>
<td style="text-align: right;">78k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">nes1980-nes</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">40</td>
<td style="text-align: right;">1.5k</td>
<td style="text-align: right;">380</td>
<td style="text-align: right;">8.3k</td>
<td style="text-align: right;">85k</td>
</tr>
<tr class="even">
<td style="text-align: right;">low_dim_gauss_mix_collapse-low_dim_gauss_mix_collapse</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">42</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">11k</td>
<td style="text-align: right;">40k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">sir-sir</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">47</td>
<td style="text-align: right;">800</td>
<td style="text-align: right;">310</td>
<td style="text-align: right;">6.7k</td>
<td style="text-align: right;">120k</td>
</tr>
<tr class="even">
<td style="text-align: right;">kidiq-kidscore_momhsiq</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">67</td>
<td style="text-align: right;">970</td>
<td style="text-align: right;">320</td>
<td style="text-align: right;">6.4k</td>
<td style="text-align: right;">140k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">earnings-log10earn_height</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">75</td>
<td style="text-align: right;">970</td>
<td style="text-align: right;">310</td>
<td style="text-align: right;">6.1k</td>
<td style="text-align: right;">150k</td>
</tr>
<tr class="even">
<td style="text-align: right;">earnings-logearn_height</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">82</td>
<td style="text-align: right;">960</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">5.6k</td>
<td style="text-align: right;">120k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">earnings-logearn_height_male</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">110</td>
<td style="text-align: right;">990</td>
<td style="text-align: right;">300</td>
<td style="text-align: right;">6.6k</td>
<td style="text-align: right;">210k</td>
</tr>
<tr class="even">
<td style="text-align: right;">diamonds-diamonds</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">110</td>
<td style="text-align: right;">430</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">25k</td>
<td style="text-align: right;">1.5M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kidiq-kidscore_interaction</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">130</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">7.5k</td>
<td style="text-align: right;">170k</td>
</tr>
<tr class="even">
<td style="text-align: right;">mesquite-mesquite</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">180</td>
<td style="text-align: right;">870</td>
<td style="text-align: right;">500</td>
<td style="text-align: right;">11k</td>
<td style="text-align: right;">1M</td>
</tr>
<tr class="odd">
<td style="text-align: right;">earnings-logearn_interaction</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">180</td>
<td style="text-align: right;">1.1k</td>
<td style="text-align: right;">280</td>
<td style="text-align: right;">7.1k</td>
<td style="text-align: right;">320k</td>
</tr>
<tr class="even">
<td style="text-align: right;">earnings-logearn_logheight_male</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">520</td>
<td style="text-align: right;">1.2k</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">5.9k</td>
<td style="text-align: right;">460k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">kilpisjarvi_mod-kilpisjarvi</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">1.1k</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">6.1k</td>
<td style="text-align: right;">1.3M</td>
</tr>
<tr class="even">
<td style="text-align: right;">earnings-earn_height</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right; color: blue; font-weight: bold;">2.2k</td>
<td style="text-align: right;">980</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">5.9k</td>
<td style="text-align: right;">800k</td>
</tr>
<tr class="odd">
<td style="text-align: right;">traffic_accident_nyc-bym2_offset_only</td>
<td style="text-align: right;">3845</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">timssAusTwn_irt-gpcm_latent_reg_irt</td>
<td style="text-align: right;">530</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">three_men3-ldaK2</td>
<td style="text-align: right;">505</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">three_men2-ldaK2</td>
<td style="text-align: right;">510</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">three_men1-ldaK2</td>
<td style="text-align: right;">502</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">synthetic_grid_RBF_kernels-kronecker_gp</td>
<td style="text-align: right;">438</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">state_wide_presidential_votes-hierarchical_gp</td>
<td style="text-align: right;">933</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">science_irt-grsm_latent_reg_irt</td>
<td style="text-align: right;">408</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">sat-hier_2pl</td>
<td style="text-align: right;">669</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_mod-radon_county</td>
<td style="text-align: right;">389</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_variable_slope_noncentered</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_variable_slope_centered</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_variable_intercept_slope_noncentered</td>
<td style="text-align: right;">777</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_variable_intercept_slope_centered</td>
<td style="text-align: right;">777</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_variable_intercept_noncentered</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_variable_intercept_centered</td>
<td style="text-align: right;">390</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_partially_pooled_noncentered</td>
<td style="text-align: right;">389</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_partially_pooled_centered</td>
<td style="text-align: right;">389</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_hierarchical_intercept_noncentered</td>
<td style="text-align: right;">391</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">radon_all-radon_hierarchical_intercept_centered</td>
<td style="text-align: right;">391</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">radon_all-radon_county_intercept</td>
<td style="text-align: right;">388</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">prostate-logistic_regression_rhs</td>
<td style="text-align: right;">11935</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">prideprejudice_paragraph-ldaK5</td>
<td style="text-align: right;">15570</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">prideprejudice_chapter-ldaK5</td>
<td style="text-align: right;">7714</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">ovarian-logistic_regression_rhs</td>
<td style="text-align: right;">3075</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">mnist_100-nn_rbm1bJ10</td>
<td style="text-align: right;">7951</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">mnist-nn_rbm1bJ100</td>
<td style="text-align: right;">79411</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">lsat_data-lsat_model</td>
<td style="text-align: right;">1006</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">iohmm_reg_simulated-iohmm_reg</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">hmm_gaussian_simulated-hmm_gaussian</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">hmm_example-hmm_example</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">fims_Aus_Jpn_irt-2pl_latent_reg_irt</td>
<td style="text-align: right;">531</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">election88-election88_full</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">ecdc0501-covid19imperial_v3</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">ecdc0501-covid19imperial_v2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">ecdc0401-covid19imperial_v3</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">ecdc0401-covid19imperial_v2</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">bball_drive_event_1-hmm_drive_1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">bball_drive_event_0-hmm_drive_0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="even">
<td style="text-align: right;">Mth_data-Mth_model</td>
<td style="text-align: right;">394</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Mh_data-Mh_model</td>
<td style="text-align: right;">388</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
<td style="text-align: right;">missing</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sampling-efficiency-comparison-non-linear-transformations" class="level2">
<h2 class="anchored" data-anchor-id="sampling-efficiency-comparison-non-linear-transformations">Sampling efficiency comparison: non-linear transformations</h2>
<p>TBA</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>